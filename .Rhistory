devtools::load_all()
library(lisat)
set.seed(12345)
n_rows <- 10000
sample_names <- c("Sample_A", "Sample_B", "Sample_C")
chr_list <- paste0(1:23)
# Generate random data
Sample <- sample(sample_names, size = n_rows, replace = TRUE)
SCount <- sample(1:1000, size = n_rows, replace = TRUE)
Chr <- sample(chr_list, size = n_rows, replace = TRUE)
Locus <- sample(1:150000000, size = n_rows, replace = TRUE)
IS_raw <- data.frame(
Sample = Sample,
SCount = SCount,
Chr = Chr,
Locus = Locus,
stringsAsFactors = FALSE
)
# Simulate some high-frequency clones (updated)
IS_raw$SCount[1:100] <- sample(500000:800000, 100, replace = TRUE)
head(IS_raw)
Validate the data structure:
```{r validate_data}
check_validity <- validate_IS_raw(IS_raw)
```{r patient_meta}
Patient_timepoint <- data.frame(
Sample_ID = c("Sample_A", "Sample_B", "Sample_C"),
Time_Point = c("3m", "12m", "24m"),
Patient_ID = rep("Pt1", 3),
stringsAsFactors = FALSE
)
head(Patient_timepoint)
if (requireNamespace("TxDb.Hsapiens.UCSC.hg38.knownGene", quietly = TRUE) &&
requireNamespace("org.Hs.eg.db", quietly = TRUE)) {
IS_raw <- get_feature(IS_raw)
# Check for overlap with specific genomic elements
IS_raw <- Enhancer_check(IS_raw)
IS_raw <- Promotor_check(IS_raw)
IS_raw <- Safeharbor_check(IS_raw)
names(IS_raw)
} else {
message("Skipping annotation: Required annotation packages not installed.")
}
CIS_top <- CIS(IS_raw = IS_raw, connect_distance = 50000)
CIS_by_sample <- CIS_overlap(CIS_data = CIS_top, IS_raw = IS_raw)
head(CIS_by_sample)
CIS_top <- CIS(IS_raw = IS_raw, connect_distance = 50000)
CIS_by_sample <- CIS_overlap(CIS_data = CIS_top, IS_raw = IS_raw)
print(CIS_by_sample)
chr_stats <- chr_distribution(IS_raw)
print(chr_stats)
if (requireNamespace("TxDb.Hsapiens.UCSC.hg38.knownGene", quietly = TRUE) &&
requireNamespace("org.Hs.eg.db", quietly = TRUE)) {
# Adverse Event genes
ae_overlap <- is_in_AE_gene(IS_raw = IS_raw, Distance = 100000)
# Cancer Genes
cg_overlap <- is_in_CG_gene(IS_raw = IS_raw, threashold = 0.001)
# Immune Genes
immune_overlap <- is_in_immune_gene(IS_raw = IS_raw, threashold = 0.001)
}
if (requireNamespace("TxDb.Hsapiens.UCSC.hg38.knownGene", quietly = TRUE) &&
requireNamespace("org.Hs.eg.db", quietly = TRUE)) {
# Adverse Event genes
ae_overlap <- is_in_AE_gene(IS_raw = IS_raw, Distance = 100000)
# Cancer Genes
cg_overlap <- is_in_CG_gene(IS_raw = IS_raw, threashold = 0.001)
print(cg_overlap)
# Immune Genes
immune_overlap <- is_in_immune_gene(IS_raw = IS_raw, threashold = 0.001)
}
PMD_data <- pmd_analysis(IS_raw = IS_raw, Patient_timepoint = Patient_timepoint)
# Plot Richness and Evenness
plot_richness_evenness(PMD_data = PMD_data)
PMD_data <- pmd_analysis(IS_raw = IS_raw, Patient_timepoint = Patient_timepoint)
# Plot Richness and Evenness
plot_richness_evenness(PMD_data = PMD_data)
# Analyze linked timepoints
linked_data <- Linked_timepoints(IS_raw = IS_raw, Patient_timepoint = Patient_timepoint)
head(linked_data)
PMD_data <- pmd_analysis(IS_raw = IS_raw, Patient_timepoint = Patient_timepoint)
# Plot Richness and Evenness
plot_richness_evenness(PMD_data = PMD_data)
# Analyze linked timepoints
linked_data <- Linked_timepoints(IS_raw = IS_raw, Patient_timepoint = Patient_timepoint)
print(linked_data)
IS_ratio <- fit_cum_simple(IS_raw$SCount)
# Cumulative_curve(IS_ratio) # Function for plotting
IS_ratio <- fit_cum_simple(IS_raw$SCount)
Cumulative_curve(IS_ratio) # Function for plotting
rmarkdown::render("lisat/vignettes/lisat-intro.Rmd")
setwd('../')
getwd()
rmarkdown::render("lisat/vignettes/lisat-intro.Rmd")
getwd()
setwd('../')
getwd()
rmarkdown::render("lisat/vignettes/lisat-intro.Rmd")
setwd('lisat/')
library(devtools)
getwd()
test()
library(devtools)
# 严格模拟CRAN的检查规则，任何WARNING/ERROR都会终止
check(
cran = TRUE,        # 启用CRAN的严格检查规则
run_dont_test = TRUE,  # 运行所有示例（包括@donttest）
error_on = "warning",  # 有WARNING就报错，提前发现问题
force_suggests = TRUE  # 检查所有Suggests依赖
)
library(lisat)
print(Cumulative_curve(IS_ratio)) # Function for plotting
IS_ratio <- fit_cum_simple(IS_raw$SCount)
print(Cumulative_curve(IS_ratio)) # Function for plotting
devtools::load_all()
# 严格模拟CRAN的检查规则，任何WARNING/ERROR都会终止
check(
cran = TRUE,        # 启用CRAN的严格检查规则
run_dont_test = TRUE,  # 运行所有示例（包括@donttest）
error_on = "warning",  # 有WARNING就报错，提前发现问题
force_suggests = TRUE  # 检查所有Suggests依赖
)
# 严格模拟CRAN的检查规则，任何WARNING/ERROR都会终止
check(
cran = TRUE,        # 启用CRAN的严格检查规则
run_dont_test = TRUE,  # 运行所有示例（包括@donttest）
error_on = "warning",  # 有WARNING就报错，提前发现问题
force_suggests = TRUE  # 检查所有Suggests依赖
)
rmarkdown::render("lisat/vignettes/lisat-intro.Rmd")
setwd('../')
rmarkdown::render("lisat/vignettes/lisat-intro.Rmd")
setwd('lisat/')
library(devtools)
getwd()
test()
library(devtools)
# 严格模拟CRAN的检查规则，任何WARNING/ERROR都会终止
check(
cran = TRUE,        # 启用CRAN的严格检查规则
run_dont_test = TRUE,  # 运行所有示例（包括@donttest）
error_on = "warning",  # 有WARNING就报错，提前发现问题
force_suggests = TRUE  # 检查所有Suggests依赖
)
build(
path = ".",
binary = FALSE,  # 必须为 FALSE（源码包）
vignettes = TRUE,
manual = TRUE
)
build(
path = ".",
binary = FALSE,  # 必须为 FALSE（源码包）
vignettes = TRUE,
manual = TRUE
)
